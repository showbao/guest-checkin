<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä¾†è³“ç°½åˆ°</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; height: 100vh; display: flex; align-items: center; justify-content: center; font-family: sans-serif; }
    .card-box { background: white; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); padding: 30px; width: 90%; max-width: 400px; text-align: center; }
    input { background: #f0f2f5; border: none; border-radius: 10px; padding: 15px; width: 100%; margin-bottom: 15px; font-size: 16px; box-sizing: border-box; }
    .btn-go { background: #000; color: white; padding: 15px; width: 100%; border-radius: 10px; font-size: 18px; font-weight: bold; border: none; cursor: pointer; }
    .btn-go:disabled { background: #999; }
    #overlay { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.95); display:none; flex-direction:column; align-items:center; justify-content:center; }
    .icon { font-size: 60px; margin-bottom: 10px; }
  </style>
</head>
<body>

<div class="card-box">
  <h2 class="mb-4">ğŸ‘‹ æ­¡è¿è’è‡¨å»ºåŠŸåœ‹å°</h2>
  <form id="form">
    <input type="text" id="title" placeholder="è·ç¨± (å¦‚ï¼šè‘£äº‹é•·)" required>
    <input type="text" id="name" placeholder="å§“å" required>
    <button type="submit" id="btn" class="btn-go">ç°½åˆ°</button>
  </form>
</div>

<div id="overlay">
  <div class="icon">âœ…</div>
  <h3>ç°½åˆ°æˆåŠŸ</h3>
  <p>å³å°‡è¿”å›é¦–é ...</p>
</div>

<script>
  // âš ï¸âš ï¸âš ï¸ è«‹å°‡ä¸‹æ–¹ç¶²å€æ›æˆä½ çš„ Google Script ç¶²å€ âš ï¸âš ï¸âš ï¸
  const API_URL = "https://script.google.com/macros/s/AKfycbw62YC7Q03CC-YL_UyBKR4JXfP_cU3OIiswA9LlHhKLIS1LJrCg2DBT441eaE880C05BA/exec";

  document.getElementById('form').addEventListener('submit', function(e) {
    e.preventDefault();
    var btn = document.getElementById('btn');
    var title = document.getElementById('title').value;
    var name = document.getElementById('name').value;

    btn.textContent = "å‚³é€ä¸­...";
    btn.disabled = true;

    // ä½¿ç”¨ sendBeacon æˆ– fetch (no-cors ä¸æœƒå›å‚³å…§å®¹ï¼Œä½†é©åˆè¡¨å–®)
    // é€™è£¡æˆ‘å€‘ç”¨ POST ç´”æ–‡å­—å‚³è¼¸ï¼Œè®“ GAS çš„ doPost è§£æ
    fetch(API_URL, {
      method: "POST",
      body: JSON.stringify({ action: "checkin", title: title, name: name })
    })
    .then(res => res.json())
    .then(data => {
      document.getElementById('overlay').style.display = 'flex';
      setTimeout(() => window.location.reload(), 2000); // 2ç§’å¾Œé‡æ•´
    })
    .catch(err => {
      alert("é€£ç·šæ€ªæ€ªçš„ï¼Œè«‹å†è©¦ä¸€æ¬¡");
      btn.disabled = false;
      btn.textContent = "ç°½åˆ°";
    });
  });
</script>

</body>
</html>
